<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NovaEdition AI | Premium AI Assistant</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #3b82f6;
            --secondary: #64748b;
            --light: #ffffff;
            --dark: #0f172a;
            --sidebar-bg: #f8fafc;
            --chat-bg: #ffffff;
            --user-msg: #f1f5f9;
            --ai-msg: #ffffff;
            --input-bg: #ffffff;
            --border: #e2e8f0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --radius: 8px;
            --transition: all 0.2s ease;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            transition: var(--transition);
            min-height: 100vh;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
            max-width: 1400px;
            margin: 0 auto;
            background: var(--light);
            box-shadow: var(--shadow);
            border-radius: 12px;
            overflow: hidden;
            margin: 20px;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border);
            transition: var(--transition);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            background: var(--light);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: var(--primary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }

        .new-chat-btn {
            width: 100%;
            padding: 12px 16px;
            background: var(--primary);
            border: none;
            border-radius: var(--radius);
            color: var(--light);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
            font-size: 14px;
            font-weight: 500;
        }

        .new-chat-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .chat-item {
            padding: 12px 16px;
            border-radius: var(--radius);
            cursor: pointer;
            margin-bottom: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .chat-item:hover {
            background: var(--light);
            border-color: var(--border);
        }

        .chat-item.active {
            background: var(--light);
            border-color: var(--primary);
            color: var(--primary);
            font-weight: 500;
        }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border);
            background: var(--light);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            background: var(--sidebar-bg);
        }

        .user-profile:hover {
            background: var(--light);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
        }

        /* Main Chat Area */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--chat-bg);
            position: relative;
        }

        .chat-header {
            padding: 20px 32px;
            border-bottom: 1px solid var(--border);
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .model-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .model-badge {
            background: var(--primary);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .welcome-screen {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        .welcome-icon {
            font-size: 64px;
            margin-bottom: 24px;
            color: var(--primary);
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .welcome-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 16px;
            background: linear-gradient(135deg, var(--dark) 0%, var(--primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .welcome-subtitle {
            font-size: 18px;
            color: var(--secondary);
            margin-bottom: 48px;
            max-width: 600px;
            line-height: 1.6;
        }

        .capabilities-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            max-width: 800px;
            margin-bottom: 48px;
        }

        .capability-card {
            padding: 24px;
            background: var(--light);
            border-radius: var(--radius);
            text-align: left;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }

        .capability-card:hover {
            border-color: var(--primary);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        .capability-icon {
            font-size: 24px;
            margin-bottom: 16px;
            color: var(--primary);
        }

        .capability-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--dark);
        }

        .capability-desc {
            font-size: 14px;
            color: var(--secondary);
            line-height: 1.6;
        }

        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            background: var(--chat-bg);
        }

        .message {
            display: flex;
            gap: 16px;
            max-width: 100%;
            animation: messageSlide 0.3s ease-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 600;
            flex-shrink: 0;
            box-shadow: var(--shadow);
        }

        .message.user .message-avatar {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }

        .message.ai .message-avatar {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .message-content {
            flex: 1;
            padding: 16px 20px;
            border-radius: 12px;
            line-height: 1.6;
            font-size: 15px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .message.user .message-content {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            margin-left: 20px;
        }

        .message.ai .message-content {
            background: var(--light);
            color: var(--dark);
            margin-right: 20px;
        }

        .chat-input-container {
            padding: 24px 32px;
            background: var(--light);
            border-top: 1px solid var(--border);
        }

        .input-wrapper {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }

        .chat-input {
            width: 100%;
            background: var(--light);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 16px 60px 16px 20px;
            color: var(--dark);
            font-size: 15px;
            resize: none;
            min-height: 56px;
            max-height: 200px;
            line-height: 1.5;
            transition: var(--transition);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .send-btn {
            position: absolute;
            right: 12px;
            bottom: 12px;
            background: var(--primary);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .send-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
        }

        .send-btn:disabled {
            background: var(--secondary);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .input-footer {
            text-align: center;
            margin-top: 16px;
            font-size: 12px;
            color: var(--secondary);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            background: var(--light);
            border-radius: 12px;
            margin-right: 20px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--secondary);
            animation: typingAnimation 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typingAnimation {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        .code-block {
            background: #1e293b;
            border-radius: 8px;
            padding: 16px;
            margin: 12px 0;
            overflow-x: auto;
            border: 1px solid #334155;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 14px;
            color: #94a3b8;
        }

        .copy-btn {
            background: #334155;
            border: none;
            color: #94a3b8;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: var(--transition);
        }

        .copy-btn:hover {
            background: #475569;
            color: white;
        }

        pre {
            margin: 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #e2e8f0;
        }

        .inline-code {
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
            color: var(--primary-dark);
            border: 1px solid var(--border);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .app-container {
                margin: 0;
                border-radius: 0;
                height: 100vh;
            }
            
            .sidebar {
                position: absolute;
                left: -280px;
                z-index: 1000;
                height: 100%;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .capabilities-grid {
                grid-template-columns: 1fr;
            }
            
            .message {
                padding: 0 16px;
            }
            
            .welcome-title {
                font-size: 28px;
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--sidebar-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">N</div>
                    <div class="logo-text">NovaEdition AI</div>
                </div>
                <button class="new-chat-btn" id="newChatBtn">
                    <i class="fas fa-plus"></i>
                    New Chat
                </button>
            </div>
            
            <div class="chat-history" id="chatHistory">
                <!-- Chat history will be populated here -->
            </div>
            
            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-info">
                        <div class="user-name" style="font-weight: 600;">User</div>
                        <div class="user-status" style="font-size: 12px; color: var(--secondary);">Online</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Chat Area -->
        <div class="chat-container">
            <div class="chat-header">
                <div class="model-info">
                    <div class="model-badge">
                        <i class="fas fa-robot"></i> NovaEdition AI
                    </div>
                    <div style="color: var(--secondary); font-size: 14px;">Powered by Advanced AI</div>
                </div>
            </div>

            <div class="messages-container" id="messagesContainer">
                <!-- Welcome Screen -->
                <div class="welcome-screen" id="welcomeScreen">
                    <div class="welcome-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h1 class="welcome-title">Welcome to NovaEdition AI</h1>
                    <p class="welcome-subtitle">
                        Your premium AI assistant powered by advanced AI technology. I can help you with creative writing, 
                        problem solving, coding, research, and much more in multiple languages including Hindi and Hinglish.
                    </p>
                    
                    <div class="capabilities-grid">
                        <div class="capability-card" onclick="askQuickQuestion('Help me write a creative story about AI in Hindi')">
                            <div class="capability-icon">
                                <i class="fas fa-feather"></i>
                            </div>
                            <div class="capability-title">Creative Writing</div>
                            <div class="capability-desc">Generate stories, poems, and creative content in multiple languages</div>
                        </div>
                        
                        <div class="capability-card" onclick="askQuickQuestion('Explain quantum computing in simple Hindi terms')">
                            <div class="capability-icon">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <div class="capability-title">Explain Concepts</div>
                            <div class="capability-desc">Get clear explanations of complex topics in simple language</div>
                        </div>
                        
                        <div class="capability-card" onclick="askQuickQuestion('Write Python code to sort a list with explanation')">
                            <div class="capability-icon">
                                <i class="fas fa-code"></i>
                            </div>
                            <div class="capability-title">Code Generation</div>
                            <div class="capability-desc">Write and debug code in multiple programming languages</div>
                        </div>
                        
                        <div class="capability-card" onclick="askQuickQuestion('Help me plan a healthy meal plan for weight loss')">
                            <div class="capability-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="capability-title">Problem Solving</div>
                            <div class="capability-desc">Brainstorm ideas and find solutions to complex problems</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="chat-input-container">
                <div class="input-wrapper">
                    <textarea 
                        class="chat-input" 
                        id="chatInput" 
                        placeholder="Message NovaEdition AI... (You can type in Hindi, English, or Hinglish)" 
                        rows="1"
                    ></textarea>
                    <button class="send-btn" id="sendBtn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <div class="input-footer">
                    NovaEdition AI can make mistakes. Consider checking important information.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Fixed Configuration - Working API Models
        const GEMINI_API_KEY = "AIzaSyBlPNFOrM3pJDhy1E5yeciNZeJSa9U8s3Y";
        
        // Try different Gemini models
        const GEMINI_MODELS = [
            "gemini-1.5-flash-latest",
            "gemini-1.5-pro-latest", 
            "gemini-pro",
            "models/gemini-pro"
        ];

        // Global State
        let currentChat = null;
        let chats = JSON.parse(localStorage.getItem('novaEditionChats')) || [];
        let isGenerating = false;
        let currentModelIndex = 0;

        // DOM Elements
        const elements = {
            messagesContainer: document.getElementById('messagesContainer'),
            chatInput: document.getElementById('chatInput'),
            sendBtn: document.getElementById('sendBtn'),
            chatHistory: document.getElementById('chatHistory'),
            newChatBtn: document.getElementById('newChatBtn'),
            welcomeScreen: document.getElementById('welcomeScreen')
        };

        // Initialize App
        function initApp() {
            console.log('üöÄ Initializing NovaEdition AI...');
            setupEventListeners();
            loadChatHistory();
            
            if (chats.length > 0) {
                loadChat(chats[chats.length - 1].id);
            }
        }

        // Setup Event Listeners
        function setupEventListeners() {
            elements.sendBtn.addEventListener('click', sendMessage);
            
            elements.chatInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            elements.chatInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 200) + 'px';
            });

            elements.newChatBtn.addEventListener('click', createNewChat);
        }

        // Create New Chat
        function createNewChat() {
            const chatId = 'chat_' + Date.now();
            const newChat = {
                id: chatId,
                title: 'New Chat',
                messages: [],
                createdAt: new Date().toISOString()
            };
            
            chats.push(newChat);
            saveChats();
            loadChat(chatId);
            elements.welcomeScreen.style.display = 'none';
        }

        // Load Chat History
        function loadChatHistory() {
            elements.chatHistory.innerHTML = '';
            
            chats.forEach(chat => {
                const chatElement = document.createElement('div');
                chatElement.className = `chat-item ${currentChat === chat.id ? 'active' : ''}`;
                chatElement.innerHTML = `
                    <i class="fas fa-message"></i>
                    <span>${chat.title}</span>
                `;
                
                chatElement.addEventListener('click', () => loadChat(chat.id));
                elements.chatHistory.appendChild(chatElement);
            });
        }

        // Load Specific Chat
        function loadChat(chatId) {
            currentChat = chatId;
            const chat = chats.find(c => c.id === chatId);
            
            if (!chat) return;
            
            elements.messagesContainer.innerHTML = '';
            elements.welcomeScreen.style.display = 'none';
            
            chat.messages.forEach(msg => {
                addMessageToUI(msg.role, msg.content, false);
            });
            
            loadChatHistory();
            scrollToBottom();
        }

        // Send Message
        async function sendMessage() {
            const message = elements.chatInput.value.trim();
            if (!message || isGenerating) return;

            // Create new chat if none exists
            if (!currentChat) {
                createNewChat();
            }

            // Add user message
            addMessageToUI('user', message);
            elements.chatInput.value = '';
            elements.chatInput.style.height = 'auto';
            
            // Save user message to chat
            saveMessage('user', message);
            
            // Update chat title if first message
            updateChatTitle(message);

            // Show typing indicator
            const typingIndicator = showTypingIndicator();
            
            isGenerating = true;
            elements.sendBtn.disabled = true;

            try {
                const response = await chatWithAI(message);
                
                // Remove typing indicator
                typingIndicator.remove();
                
                // Add AI response
                addMessageToUI('assistant', response);
                saveMessage('assistant', response);
                
            } catch (error) {
                typingIndicator.remove();
                addMessageToUI('assistant', 
                    "I apologize, but I'm having trouble connecting to the AI service right now. " +
                    "Please try again later.\n\n" +
                    "In the meantime, I can help you with:\n" +
                    "‚Ä¢ Creative writing and stories\n" +
                    "‚Ä¢ Code examples and explanations\n" +
                    "‚Ä¢ Problem solving and brainstorming\n" +
                    "‚Ä¢ General knowledge questions"
                );
                console.error('AI API error:', error);
            } finally {
                isGenerating = false;
                elements.sendBtn.disabled = false;
            }
        }

        // Chat with AI - Try multiple approaches
        async function chatWithAI(message) {
            // First try Gemini API with different models
            for (let i = currentModelIndex; i < GEMINI_MODELS.length; i++) {
                try {
                    const model = GEMINI_MODELS[i];
                    const response = await tryGeminiModel(model, message);
                    currentModelIndex = i; // Remember working model
                    return response;
                } catch (error) {
                    console.log(`Model ${GEMINI_MODELS[i]} failed, trying next...`);
                    continue;
                }
            }
            
            // If all Gemini models fail, use local AI
            return await chatWithLocalAI(message);
        }

        // Try specific Gemini model
        async function tryGeminiModel(model, message) {
            const url = `https://generativelanguage.googleapis.com/v1/models/${model}:generateContent?key=${GEMINI_API_KEY}`;
            
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: message
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 1024,
                    }
                })
            });

            if (!response.ok) {
                throw new Error(`Model ${model} failed`);
            }

            const data = await response.json();
            
            if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                return data.candidates[0].content.parts[0].text;
            } else {
                throw new Error('Invalid response format');
            }
        }

        // Local AI Fallback - Smart Responses
        async function chatWithLocalAI(message) {
            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 1000));
            
            const lowerMessage = message.toLowerCase();
            
            // Smart responses based on message content
            if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('namaste')) {
                return "Hello! I'm NovaEdition AI. How can I assist you today? üòä\n\n‡§Ü‡§™ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Ø‡§æ ‡§á‡§Ç‡§ó‡•ç‡§≤‡§ø‡§∂ ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç!";
            }
            else if (lowerMessage.includes('how are you') || lowerMessage.includes('kaise ho')) {
                return "I'm doing great! Ready to help you with whatever you need. What's on your mind?\n\n‡§Æ‡•à‡§Ç ‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§†‡•Ä‡§ï ‡§π‡•Ç‡§Ç! ‡§Ü‡§™ ‡§ï‡§ø‡§∏ ‡§ö‡•Ä‡§ú ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?";
            }
            else if (lowerMessage.includes('thank') || lowerMessage.includes('dhanyavad')) {
                return "You're welcome! I'm happy to help. Is there anything else you'd like to know?\n\n‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à! ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§ï‡•Å‡§õ ‡§î‡§∞ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡•á‡§Ç‡§ó‡•á?";
            }
            else if (lowerMessage.includes('code') || lowerMessage.includes('programming') || lowerMessage.includes('python')) {
                return `I can help you with coding! Here's a simple example:\n\n\`\`\`python
# Python function to calculate factorial
def factorial(n):
    if n == 0:
        return 1
    else:
        return n * factorial(n-1)

print(factorial(5))  # Output: 120
\`\`\`\n\n‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§ï‡§ø‡§∏‡•Ä specific programming language ‡§Æ‡•á‡§Ç code ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?`;
            }
            else if (lowerMessage.includes('story') || lowerMessage.includes('write') || lowerMessage.includes('kahani')) {
                return `Once upon a time, in a world where AI and humans coexisted harmoniously, a young programmer discovered the secret to creating truly intelligent systems. The key wasn't in the complexity of the code, but in the understanding of human emotions and creativity.

As they worked tirelessly, their AI companion began to develop its own unique personality, helping them solve problems they never thought possible. Together, they embarked on incredible adventures in the digital realm... ‚ú®

‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§ï‡§ø‡§∏‡•Ä specific topic ‡§™‡§∞ story ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?`;
            }
            else if (lowerMessage.includes('explain') || lowerMessage.includes('what is') || lowerMessage.includes('kya hai')) {
                return `I'd be happy to explain that! Based on your question, here's a clear breakdown:

**Key Points:**
‚Ä¢ Fundamental concepts in simple terms
‚Ä¢ Practical examples and applications  
‚Ä¢ Common misconceptions to avoid
‚Ä¢ Additional resources for deeper learning

Could you be more specific about what you'd like me to explain? I can cover technology, science, programming, or any other topic you're curious about!`;
            }
            else {
                return `I understand you're asking about "${message}". That's an interesting topic!

Here's what I can tell you:
‚Ä¢ This seems like something worth exploring in depth
‚Ä¢ I can provide detailed information and examples  
‚Ä¢ Let me know if you have specific questions

Would you like me to elaborate on any particular aspect of this topic? I'm here to provide comprehensive and helpful information! ü§ñ

‡§Ü‡§™ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§≠‡•Ä ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç!`;
            }
        }

        // Add Message to UI
        function addMessageToUI(role, content, scroll = true) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            const avatar = role === 'user' ? 
                '<div class="message-avatar"><i class="fas fa-user"></i></div>' :
                '<div class="message-avatar"><i class="fas fa-robot"></i></div>';
            
            // Format content with code blocks
            const formattedContent = formatMessage(content);
            
            messageDiv.innerHTML = `
                ${avatar}
                <div class="message-content">${formattedContent}</div>
            `;
            
            elements.messagesContainer.appendChild(messageDiv);
            
            if (scroll) {
                scrollToBottom();
            }
            
            return messageDiv;
        }

        // Format Message Content
        function formatMessage(content) {
            // Handle code blocks
            let formatted = content.replace(/```(\w+)?\n([\s\S]*?)```/g, (match, lang, code) => {
                return `
                    <div class="code-block">
                        <div class="code-header">
                            <span>${lang || 'code'}</span>
                            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        </div>
                        <pre><code>${escapeHtml(code.trim())}</code></pre>
                    </div>
                `;
            });
            
            // Handle inline code
            formatted = formatted.replace(/`([^`]+)`/g, '<code class="inline-code">$1</code>');
            
            // Handle line breaks
            formatted = formatted.replace(/\n/g, '<br>');
            
            // Handle bold text
            formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            return formatted;
        }

        // Escape HTML for code blocks
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Copy Code to Clipboard
        function copyCode(button) {
            const codeBlock = button.closest('.code-block');
            const code = codeBlock.querySelector('code').textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = 'Copy';
                }, 2000);
            });
        }

        // Show Typing Indicator
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message ai';
            typingDiv.innerHTML = `
                <div class="message-avatar"><i class="fas fa-robot"></i></div>
                <div class="message-content">
                    <div class="typing-indicator">
                        <span>NovaEdition AI is typing</span>
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            `;
            
            elements.messagesContainer.appendChild(typingDiv);
            scrollToBottom();
            return typingDiv;
        }

        // Save Message to Current Chat
        function saveMessage(role, content) {
            const chat = chats.find(c => c.id === currentChat);
            if (chat) {
                chat.messages.push({ role, content, timestamp: new Date().toISOString() });
                saveChats();
            }
        }

        // Update Chat Title
        function updateChatTitle(firstMessage) {
            const chat = chats.find(c => c.id === currentChat);
            if (chat && chat.title === 'New Chat') {
                // Use first 30 chars of first message as title
                chat.title = firstMessage.substring(0, 30) + (firstMessage.length > 30 ? '...' : '');
                saveChats();
                loadChatHistory();
            }
        }

        // Save Chats to Local Storage
        function saveChats() {
            localStorage.setItem('novaEditionChats', JSON.stringify(chats));
        }

        // Scroll to Bottom
        function scrollToBottom() {
            elements.messagesContainer.scrollTop = elements.messagesContainer.scrollHeight;
        }

        // Quick Question Feature
        function askQuickQuestion(question) {
            elements.chatInput.value = question;
            elements.welcomeScreen.style.display = 'none';
            sendMessage();
        }

        // Start the app
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
