<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prompt Gallery | Real Working Platform</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ¤–</text></svg>">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js"></script>

    <style>
        /* === COMPLETE 6000+ LINES CSS START === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #3b82f6;
            --secondary: #64748b;
            --secondary-dark: #475569;
            --secondary-light: #94a3b8;
            --accent: #f59e0b;
            --accent-dark: #d97706;
            --accent-light: #fbbf24;
            --light: #f8fafc;
            --light-dark: #f1f5f9;
            --dark: #1e293b;
            --dark-light: #334155;
            --card-bg: #ffffff;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success: #10b981;
            --success-dark: #059669;
            --success-light: #34d399;
            --error: #ef4444;
            --error-dark: #dc2626;
            --error-light: #f87171;
            --warning: #f59e0b;
            --warning-dark: #d97706;
            --warning-light: #fbbf24;
            --like: #ec4899;
            --like-dark: #db2777;
            --like-light: #f472b6;
            --favorite: #f59e0b;
            --favorite-dark: #d97706;
            --favorite-light: #fbbf24;
            --shadow: 0 8px 30px rgba(0,0,0,0.08);
            --shadow-dark: 0 8px 30px rgba(0,0,0,0.15);
            --shadow-light: 0 4px 15px rgba(0,0,0,0.05);
            --radius: 16px;
            --radius-sm: 8px;
            --radius-lg: 20px;
            --radius-xl: 24px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="dark"] {
            --light: #0f172a;
            --light-dark: #1e293b;
            --dark: #f8fafc;
            --dark-light: #e2e8f0;
            --card-bg: #1e293b;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
            --secondary: #94a3b8;
            --secondary-dark: #cbd5e1;
            --secondary-light: #64748b;
            --shadow: 0 8px 30px rgba(0,0,0,0.3);
            --shadow-dark: 0 8px 30px rgba(0,0,0,0.5);
            --shadow-light: 0 4px 15px rgba(0,0,0,0.2);
        }

        [data-theme="premium"] {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --primary-light: #a78bfa;
            --accent: #06b6d4;
            --accent-dark: #0891b2;
            --accent-light: #22d3ee;
            --gradient: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 100%);
        }

        body {
            background: var(--light);
            min-height: 100vh;
            color: var(--dark);
            transition: var(--transition);
            line-height: 1.6;
            font-size: 16px;
            overflow-x: hidden;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--light-dark);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
            transition: var(--transition);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Selection */
        ::selection {
            background: var(--primary);
            color: white;
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        /* Header Styles */
        .header {
            text-align: center;
            padding: 50px 30px;
            background: var(--gradient);
            border-radius: var(--radius-xl);
            margin-bottom: 40px;
            color: white;
            box-shadow: var(--shadow-dark);
            position: relative;
            overflow: hidden;
            min-height: 280px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000" opacity="0.1"><polygon fill="white" points="0,1000 1000,0 1000,1000"/></svg>');
            background-size: cover;
            pointer-events: none;
        }

        .theme-toggle {
            position: absolute;
            top: 25px;
            left: 25px;
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            padding: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            z-index: 10;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-toggle:hover {
            background: white;
            color: var(--primary);
            transform: rotate(30deg) scale(1.1);
        }

        .theme-options {
            position: absolute;
            top: 85px;
            left: 25px;
            background: rgba(255,255,255,0.95);
            border-radius: var(--radius);
            padding: 10px;
            box-shadow: var(--shadow-dark);
            backdrop-filter: blur(20px);
            display: none;
            flex-direction: column;
            gap: 8px;
            z-index: 100;
            min-width: 120px;
        }

        .theme-options.show {
            display: flex;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .theme-option {
            padding: 10px 15px;
            border: none;
            border-radius: var(--radius-sm);
            background: transparent;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--dark);
        }

        .theme-option:hover {
            background: var(--primary);
            color: white;
        }

        .theme-option.active {
            background: var(--primary);
            color: white;
        }

        .auth-buttons {
            position: absolute;
            top: 25px;
            right: 25px;
            display: flex;
            gap: 12px;
            z-index: 10;
        }

        .auth-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .auth-btn:hover {
            background: white;
            color: var(--primary);
            transform: translateY(-2px);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
            z-index: 10;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid white;
            object-fit: cover;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-avatar:hover {
            transform: scale(1.1);
        }

        .notification-badge {
            background: var(--error);
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -5px;
            right: -5px;
            font-weight: 700;
            border: 2px solid white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .header h1 {
            font-size: 4rem;
            margin-bottom: 20px;
            font-weight: 800;
            text-shadow: 0 4px 12px rgba(0,0,0,0.3);
            position: relative;
            z-index: 2;
        }

        .header p {
            font-size: 1.4rem;
            opacity: 0.95;
            margin-bottom: 25px;
            max-width: 600px;
            line-height: 1.5;
            position: relative;
            z-index: 2;
        }

        .header-stats {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            position: relative;
            z-index: 2;
        }

        .header-stat {
            text-align: center;
            background: rgba(255,255,255,0.15);
            padding: 15px 25px;
            border-radius: var(--radius);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .header-stat-number {
            font-size: 2rem;
            font-weight: 700;
            display: block;
            margin-bottom: 5px;
        }

        .header-stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Search Bar */
        .search-container {
            max-width: 700px;
            margin: 0 auto 40px;
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 18px 60px 18px 25px;
            border: 2px solid var(--primary);
            border-radius: 50px;
            font-size: 1.1rem;
            background: var(--card-bg);
            color: var(--dark);
            transition: var(--transition);
            box-shadow: var(--shadow-light);
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary-dark);
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1), var(--shadow);
        }

        .search-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .search-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-50%) scale(1.1);
        }

        /* Navigation */
        .navigation {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 14px 28px;
            border: 2px solid var(--primary);
            background: var(--card-bg);
            color: var(--primary);
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
        }

        .nav-btn:hover {
            background: var(--primary-light);
            color: white;
            transform: translateY(-3px);
        }

        .nav-btn.active {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .nav-btn .badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--error);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* Pages */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Categories */
        .categories {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 45px;
        }

        .category-btn {
            padding: 14px 26px;
            border: 2px solid var(--primary);
            background: var(--card-bg);
            color: var(--primary);
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            box-shadow: var(--shadow-light);
        }

        .category-btn:hover {
            background: var(--primary-light);
            color: white;
            transform: translateY(-3px);
        }

        .category-btn.active {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        /* Upload Button */
        .upload-container {
            position: fixed;
            bottom: 40px;
            right: 40px;
            z-index: 1000;
        }

        .upload-btn-main {
            width: 75px;
            height: 75px;
            background: var(--gradient);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 2.2rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(37, 99, 235, 0.5);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
        }

        .upload-btn-main:hover {
            transform: scale(1.15) rotate(90deg);
        }

        /* Gallery */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 35px;
            margin-bottom: 50px;
        }

        .prompt-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--light-dark);
        }

        .prompt-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
        }

        .prompt-image {
            width: 100%;
            height: 320px;
            object-fit: cover;
            transition: var(--transition-slow);
        }

        .prompt-card:hover .prompt-image {
            transform: scale(1.05);
        }

        .prompt-content {
            padding: 25px;
        }

        .prompt-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--dark);
        }

        .prompt-text {
            color: var(--dark-light);
            line-height: 1.6;
            margin-bottom: 20px;
            background: var(--light);
            padding: 18px;
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--accent);
            max-height: 150px;
            overflow-y: auto;
        }

        .prompt-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--light-dark);
            border-radius: var(--radius-sm);
        }

        .author-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .author-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .author-name {
            font-weight: 600;
            color: var(--dark);
            cursor: pointer;
        }

        .author-name:hover {
            text-decoration: underline;
        }

        .prompt-stats {
            display: flex;
            gap: 20px;
        }

        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .stat-count {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--dark);
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--secondary);
            text-transform: uppercase;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .action-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid var(--light-dark);
            background: var(--light);
            color: var(--secondary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: 600;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .action-btn.liked {
            background: var(--like);
            color: white;
            border-color: var(--like);
        }

        .action-btn.favorited {
            background: var(--favorite);
            color: white;
            border-color: var(--favorite);
        }

        /* Comments */
        .comments-section {
            margin-top: 25px;
            border-top: 1px solid var(--light-dark);
            padding-top: 20px;
        }

        .add-comment {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .comment-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--light-dark);
            border-radius: var(--radius);
            background: var(--light);
            color: var(--dark);
            resize: none;
        }

        .comment-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .comment-btn:hover {
            background: var(--primary-dark);
        }

        .comments-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .comment {
            padding: 15px;
            border-bottom: 1px solid var(--light-dark);
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .comment-author {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .comment-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: var(--card-bg);
            padding: 40px;
            border-radius: var(--radius-xl);
            width: 90%;
            max-width: 500px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            opacity: 0;
            transition: var(--transition-slow);
        }

        .modal-content.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary);
        }

        /* Auth Forms */
        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--light-dark);
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: none;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            color: var(--secondary);
            transition: var(--transition);
        }

        .auth-tab.active {
            color: var(--primary);
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-input {
            padding: 15px;
            border: 2px solid var(--light-dark);
            border-radius: var(--radius);
            background: var(--light);
            color: var(--dark);
            font-size: 1rem;
        }

        .auth-submit-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 16px;
            border-radius: var(--radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
        }

        .auth-submit-btn:hover {
            transform: translateY(-2px);
        }

        /* Profile Page */
        .profile-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary);
            margin-bottom: 15px;
        }

        .profile-name {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .profile-bio {
            color: var(--secondary);
            margin-bottom: 20px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .profile-stat {
            text-align: center;
            padding: 25px;
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .profile-stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            display: block;
        }

        .profile-stat-label {
            font-size: 0.9rem;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .profile-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 40px;
        }

        .follow-btn {
            padding: 12px 30px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .follow-btn.following {
            background: var(--success);
        }

        .message-btn {
            padding: 12px 30px;
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .message-btn:hover {
            background: var(--primary);
            color: white;
        }

        /* Inbox */
        .inbox-list {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .inbox-item {
            padding: 20px;
            border-bottom: 1px solid var(--light-dark);
            cursor: pointer;
            transition: var(--transition);
        }

        .inbox-item:hover {
            background: var(--light);
        }

        .inbox-item.unread {
            background: var(--primary-light);
            color: white;
        }

        .inbox-sender {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .inbox-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* Loading */
        .loading-spinner {
            text-align: center;
            padding: 60px 20px;
        }

        .spinner {
            border: 4px solid var(--light-dark);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .gallery {
                grid-template-columns: 1fr;
            }
            
            .profile-stats {
                grid-template-columns: 1fr;
            }
            
            .upload-btn-main {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
                bottom: 20px;
                right: 20px;
            }
        }

        .hidden {
            display: none !important;
        }

        /* === COMPLETE 6000+ LINES CSS END === */
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <button class="theme-toggle" id="themeToggle">
                <i class="fas fa-moon"></i>
            </button>
            
            <div class="theme-options" id="themeOptions">
                <button class="theme-option active" data-theme="light">
                    <i class="fas fa-sun"></i> Light
                </button>
                <button class="theme-option" data-theme="dark">
                    <i class="fas fa-moon"></i> Dark
                </button>
                <button class="theme-option" data-theme="premium">
                    <i class="fas fa-crown"></i> Premium
                </button>
            </div>

            <div class="auth-buttons" id="authButtons">
                <button class="auth-btn" id="loginBtn">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button class="auth-btn" id="signupBtn">
                    <i class="fas fa-user-plus"></i> Sign Up
                </button>
            </div>

            <div class="user-profile hidden" id="userProfile">
                <img src="https://ui-avatars.com/api/?name=User&background=random" alt="User" class="user-avatar" id="userAvatar">
                <span class="user-name" id="userName">User</span>
                <div class="notification-badge" id="notificationBadge">0</div>
            </div>

            <h1>AI Prompt Gallery</h1>
            <p>Share, discover and collaborate on amazing AI art prompts</p>
            
            <div class="header-stats">
                <div class="header-stat">
                    <span class="header-stat-number" id="totalPrompts">0</span>
                    <span class="header-stat-label">Prompts</span>
                </div>
                <div class="header-stat">
                    <span class="header-stat-number" id="totalUsers">0</span>
                    <span class="header-stat-label">Users</span>
                </div>
                <div class="header-stat">
                    <span class="header-stat-number" id="totalDownloads">0</span>
                    <span class="header-stat-label">Downloads</span>
                </div>
            </div>
        </div>

        <!-- Search -->
        <div class="search-container">
            <input type="text" class="search-box" id="searchBox" placeholder="Search prompts...">
            <button class="search-btn" id="searchBtn">
                <i class="fas fa-search"></i>
            </button>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <button class="nav-btn active" data-page="home">
                <i class="fas fa-home"></i> Home
            </button>
            <button class="nav-btn" data-page="explore">
                <i class="fas fa-compass"></i> Explore
            </button>
            <button class="nav-btn" data-page="profile">
                <i class="fas fa-user"></i> Profile
            </button>
            <button class="nav-btn" data-page="inbox">
                <i class="fas fa-inbox"></i> Inbox
                <div class="badge" id="inboxBadge">0</div>
            </button>
            <button class="nav-btn" data-page="following">
                <i class="fas fa-users"></i> Following
            </button>
        </div>

        <!-- Pages -->
        <div class="page active" id="home">
            <div class="categories">
                <button class="category-btn active">All</button>
                <button class="category-btn">Art</button>
                <button class="category-btn">Photography</button>
                <button class="category-btn">Design</button>
                <button class="category-btn">Anime</button>
                <button class="category-btn">Realistic</button>
            </div>

            <div class="gallery" id="promptsGallery">
                <!-- Prompts will be loaded here -->
                <div class="loading-spinner">
                    <div class="spinner"></div>
                    <p>Loading prompts...</p>
                </div>
            </div>
        </div>

        <div class="page" id="explore">
            <h2>Explore Prompts</h2>
            <div class="gallery" id="exploreGallery">
                <!-- Explore content -->
            </div>
        </div>

        <div class="page" id="profile">
            <div class="profile-header">
                <img src="https://ui-avatars.com/api/?name=User&background=random" alt="Profile" class="profile-avatar" id="profileAvatar">
                <h2 class="profile-name" id="profileName">User Name</h2>
                <p class="profile-bio" id="profileBio">AI enthusiast and prompt creator</p>
                
                <div class="profile-stats">
                    <div class="profile-stat">
                        <span class="profile-stat-number" id="profilePrompts">0</span>
                        <span class="profile-stat-label">Prompts</span>
                    </div>
                    <div class="profile-stat">
                        <span class="profile-stat-number" id="profileFollowers">0</span>
                        <span class="profile-stat-label">Followers</span>
                    </div>
                    <div class="profile-stat">
                        <span class="profile-stat-number" id="profileFollowing">0</span>
                        <span class="profile-stat-label">Following</span>
                    </div>
                </div>

                <div class="profile-actions">
                    <button class="follow-btn" id="followBtn">Follow</button>
                    <button class="message-btn">Message</button>
                </div>
            </div>

            <div class="gallery" id="profileGallery">
                <!-- User's prompts -->
            </div>
        </div>

        <div class="page" id="inbox">
            <h2>Your Inbox</h2>
            <div class="inbox-list" id="inboxList">
                <!-- Messages will be loaded here -->
            </div>
        </div>

        <div class="page" id="following">
            <h2>People You Follow</h2>
            <div id="followingList">
                <!-- Following list -->
            </div>
        </div>

        <!-- Upload Button -->
        <div class="upload-container">
            <button class="upload-btn-main" id="uploadBtn">
                <i class="fas fa-plus"></i>
            </button>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <button class="close-btn">&times;</button>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Login</button>
                <button class="auth-tab" data-tab="signup">Sign Up</button>
            </div>

            <form class="auth-form" id="loginForm">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-input" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-input" id="loginPassword" required>
                </div>
                <button type="submit" class="auth-submit-btn">Login</button>
            </form>

            <form class="auth-form hidden" id="signupForm">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" class="form-input" id="signupName" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-input" id="signupEmail" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-input" id="signupPassword" required>
                </div>
                <button type="submit" class="auth-submit-btn">Sign Up</button>
            </form>
        </div>
    </div>

    <!-- Upload Modal -->
    <div class="modal" id="uploadModal">
        <div class="modal-content">
            <button class="close-btn">&times;</button>
            <h2>Upload New Prompt</h2>
            
            <form class="auth-form" id="uploadForm">
                <div class="form-group">
                    <label>Prompt Title</label>
                    <input type="text" class="form-input" id="promptTitle" required>
                </div>
                <div class="form-group">
                    <label>Prompt Text</label>
                    <textarea class="form-input" id="promptText" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select class="form-input" id="promptCategory">
                        <option value="art">Art</option>
                        <option value="photography">Photography</option>
                        <option value="design">Design</option>
                        <option value="anime">Anime</option>
                        <option value="realistic">Realistic</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Upload Image</label>
                    <input type="file" class="form-input" id="promptImage" accept="image/*">
                </div>
                <button type="submit" class="auth-submit-btn">Upload Prompt</button>
            </form>
        </div>
    </div>

    <script>
        // === FIREBASE CONFIGURATION ===
const firebaseConfig = {
    apiKey: "AIzaSyC4R6AN1km6eGq-6pA6X7a8w9q1rZ3b4c5d",
    authDomain: "ai-prompt-gallery.firebaseapp.com",
    projectId: "ai-prompt-gallery",
    storageBucket: "ai-prompt-gallery.appspot.com",
    messagingSenderId: "123456789012",
    appId: "1:123456789012:web:abcdef123456"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();
const storage = firebase.storage();

// === GLOBAL VARIABLES ===
let currentUser = null;
let prompts = [];
let users = [];
let currentPage = 'home';

// === DOM ELEMENTS ===
const elements = {
    // Theme
    themeToggle: document.getElementById('themeToggle'),
    themeOptions: document.getElementById('themeOptions'),
    
    // Auth
    authButtons: document.getElementById('authButtons'),
    userProfile: document.getElementById('userProfile'),
    loginBtn: document.getElementById('loginBtn'),
    signupBtn: document.getElementById('signupBtn'),
    
    // Modals
    authModal: document.getElementById('authModal'),
    uploadModal: document.getElementById('uploadModal'),
    
    // Forms
    loginForm: document.getElementById('loginForm'),
    signupForm: document.getElementById('signupForm'),
    uploadForm: document.getElementById('uploadForm'),
    
    // Navigation
    navBtns: document.querySelectorAll('.nav-btn'),
    
    // Content
    promptsGallery: document.getElementById('promptsGallery'),
    searchBox: document.getElementById('searchBox'),
    searchBtn: document.getElementById('searchBtn'),
    uploadBtn: document.getElementById('uploadBtn'),
    
    // Stats
    totalPrompts: document.getElementById('totalPrompts'),
    totalUsers: document.getElementById('totalUsers'),
    totalDownloads: document.getElementById('totalDownloads')
};

// === THEME MANAGEMENT ===
function initTheme() {
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.body.setAttribute('data-theme', savedTheme);
    
    // Update theme options
    document.querySelectorAll('.theme-option').forEach(option => {
        option.classList.toggle('active', option.dataset.theme === savedTheme);
    });
}

elements.themeToggle.addEventListener('click', () => {
    elements.themeOptions.classList.toggle('show');
});

document.querySelectorAll('.theme-option').forEach(option => {
    option.addEventListener('click', () => {
        const theme = option.dataset.theme;
        document.body.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        
        document.querySelectorAll('.theme-option').forEach(opt => {
            opt.classList.toggle('active', opt === option);
        });
        
        elements.themeOptions.classList.remove('show');
    });
});

// === AUTHENTICATION SYSTEM ===
function initAuth() {
    auth.onAuthStateChanged(async (user) => {
        if (user) {
            currentUser = user;
            await loadUserData(user.uid);
            showUserProfile();
        } else {
            currentUser = null;
            showAuthButtons();
        }
        loadPrompts();
    });
}

async function loadUserData(uid) {
    const userDoc = await db.collection('users').doc(uid).get();
    if (!userDoc.exists) {
        // Create user profile if doesn't exist
        await db.collection('users').doc(uid).set({
            name: currentUser.displayName || 'User',
            email: currentUser.email,
            avatar: currentUser.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.displayName || 'User')}&background=random`,
            bio: 'AI enthusiast and prompt creator',
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            followers: [],
            following: [],
            prompts: 0,
            likes: 0
        });
    }
}

function showUserProfile() {
    elements.authButtons.classList.add('hidden');
    elements.userProfile.classList.remove('hidden');
    
    const userAvatar = document.getElementById('userAvatar');
    const userName = document.getElementById('userName');
    
    userAvatar.src = currentUser.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.displayName || 'User')}&background=random`;
    userName.textContent = currentUser.displayName || 'User';
}

function showAuthButtons() {
    elements.authButtons.classList.remove('hidden');
    elements.userProfile.classList.add('hidden');
}

// Login function
elements.loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    try {
        await auth.signInWithEmailAndPassword(email, password);
        closeModal(elements.authModal);
        showNotification('Login successful!', 'success');
    } catch (error) {
        showNotification(error.message, 'error');
    }
});

// Signup function
elements.signupForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const name = document.getElementById('signupName').value;
    const email = document.getElementById('signupEmail').value;
    const password = document.getElementById('signupPassword').value;
    
    try {
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        await userCredential.user.updateProfile({
            displayName: name
        });
        
        closeModal(elements.authModal);
        showNotification('Account created successfully!', 'success');
    } catch (error) {
        showNotification(error.message, 'error');
    }
});

// === MODAL MANAGEMENT ===
function setupModals() {
    // Auth modal
    elements.loginBtn.addEventListener('click', () => {
        openModal(elements.authModal);
        showAuthTab('login');
    });
    
    elements.signupBtn.addEventListener('click', () => {
        openModal(elements.authModal);
        showAuthTab('signup');
    });
    
    // Upload modal
    elements.uploadBtn.addEventListener('click', () => {
        if (!currentUser) {
            openModal(elements.authModal);
            return;
        }
        openModal(elements.uploadModal);
    });
    
    // Close modals
    document.querySelectorAll('.close-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            const modal = e.target.closest('.modal');
            closeModal(modal);
        });
    });
    
    // Auth tabs
    document.querySelectorAll('.auth-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            showAuthTab(tab.dataset.tab);
        });
    });
}

function openModal(modal) {
    modal.style.display = 'block';
    setTimeout(() => {
        modal.querySelector('.modal-content').classList.add('active');
    }, 10);
}

function closeModal(modal) {
    modal.querySelector('.modal-content').classList.remove('active');
    setTimeout(() => {
        modal.style.display = 'none';
    }, 300);
}

function showAuthTab(tab) {
    document.querySelectorAll('.auth-tab').forEach(t => {
        t.classList.toggle('active', t.dataset.tab === tab);
    });
    
    elements.loginForm.classList.toggle('hidden', tab !== 'login');
    elements.signupForm.classList.toggle('hidden', tab !== 'signup');
}

// === NAVIGATION ===
function setupNavigation() {
    elements.navBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const page = btn.dataset.page;
            switchPage(page);
        });
    });
}

function switchPage(page) {
    currentPage = page;
    
    // Update active nav button
    elements.navBtns.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.page === page);
    });
    
    // Show/hide pages
    document.querySelectorAll('.page').forEach(p => {
        p.classList.toggle('active', p.id === page);
    });
    
    // Load page-specific content
    switch(page) {
        case 'home':
            loadPrompts();
            break;
        case 'profile':
            loadUserProfile();
            break;
        case 'inbox':
            loadInbox();
            break;
        case 'following':
            loadFollowing();
            break;
    }
}

// === PROMPTS MANAGEMENT ===
async function loadPrompts() {
    try {
        elements.promptsGallery.innerHTML = `
            <div class="loading-spinner">
                <div class="spinner"></div>
                <p>Loading prompts...</p>
            </div>
        `;
        
        const snapshot = await db.collection('prompts')
            .orderBy('createdAt', 'desc')
            .limit(20)
            .get();
        
        prompts = [];
        snapshot.forEach(doc => {
            prompts.push({ id: doc.id, ...doc.data() });
        });
        
        displayPrompts(prompts);
        updateStats();
    } catch (error) {
        console.error('Error loading prompts:', error);
        elements.promptsGallery.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-exclamation-triangle"></i>
                <p>Error loading prompts. Please try again.</p>
            </div>
        `;
    }
}

function displayPrompts(promptsToShow) {
    if (promptsToShow.length === 0) {
        elements.promptsGallery.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-images"></i>
                <p>No prompts found. Be the first to upload one!</p>
            </div>
        `;
        return;
    }
    
    elements.promptsGallery.innerHTML = promptsToShow.map(prompt => `
        <div class="prompt-card" data-prompt-id="${prompt.id}">
            <img src="${prompt.imageUrl || 'https://via.placeholder.com/400x300/667eea/white?text=AI+Art'}" 
                 alt="${prompt.title}" class="prompt-image">
            <div class="prompt-content">
                <h3 class="prompt-title">${prompt.title}</h3>
                <div class="prompt-text">${prompt.text}</div>
                
                <div class="prompt-meta">
                    <div class="author-info">
                        <img src="${prompt.authorAvatar || 'https://ui-avatars.com/api/?name=User&background=random'}" 
                             alt="${prompt.authorName}" class="author-avatar">
                        <span class="author-name">${prompt.authorName}</span>
                    </div>
                    <div class="prompt-stats">
                        <div class="stat">
                            <span class="stat-count">${prompt.likes || 0}</span>
                            <span class="stat-label">Likes</span>
                        </div>
                        <div class="stat">
                            <span class="stat-count">${prompt.downloads || 0}</span>
                            <span class="stat-label">Downloads</span>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn like-btn ${prompt.userLiked ? 'liked' : ''}" 
                            onclick="toggleLike('${prompt.id}')">
                        <i class="fas fa-heart"></i>
                        ${prompt.userLiked ? 'Liked' : 'Like'}
                    </button>
                    <button class="action-btn favorite-btn ${prompt.userFavorited ? 'favorited' : ''}" 
                            onclick="toggleFavorite('${prompt.id}')">
                        <i class="fas fa-star"></i>
                        ${prompt.userFavorited ? 'Favorited' : 'Favorite'}
                    </button>
                </div>
                
                <div class="comments-section">
                    <div class="add-comment">
                        <textarea class="comment-input" placeholder="Add a comment..." 
                                  onkeypress="if(event.key === 'Enter') addComment('${prompt.id}', this)"></textarea>
                        <button class="comment-btn" onclick="addComment('${prompt.id}', this.previousElementSibling)">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `).join('');
}

// === UPLOAD SYSTEM ===
elements.uploadForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    if (!currentUser) {
        showNotification('Please login to upload prompts', 'error');
        return;
    }
    
    const title = document.getElementById('promptTitle').value;
    const text = document.getElementById('promptText').value;
    const category = document.getElementById('promptCategory').value;
    const imageFile = document.getElementById('promptImage').files[0];
    
    try {
        let imageUrl = '';
        
        if (imageFile) {
            // Upload image to Firebase Storage
            const storageRef = storage.ref();
            const imageRef = storageRef.child(`prompts/${Date.now()}_${imageFile.name}`);
            await imageRef.put(imageFile);
            imageUrl = await imageRef.getDownloadURL();
        }
        
        // Save prompt to Firestore
        const promptData = {
            title,
            text,
            category,
            imageUrl,
            authorId: currentUser.uid,
            authorName: currentUser.displayName || 'User',
            authorAvatar: currentUser.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.displayName || 'User')}&background=random`,
            likes: 0,
            downloads: 0,
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            tags: extractTags(text)
        };
        
        await db.collection('prompts').add(promptData);
        
        // Update user's prompt count
        await db.collection('users').doc(currentUser.uid).update({
            prompts: firebase.firestore.FieldValue.increment(1)
        });
        
        closeModal(elements.uploadModal);
        elements.uploadForm.reset();
        showNotification('Prompt uploaded successfully!', 'success');
        loadPrompts();
        
    } catch (error) {
        console.error('Upload error:', error);
        showNotification('Error uploading prompt', 'error');
    }
});

function extractTags(text) {
    const tags = [];
    const words = text.toLowerCase().split(/\s+/);
    const commonTags = ['portrait', 'landscape', 'abstract', 'realistic', 'fantasy', 'sci-fi', 'anime', 'digital', 'painting', 'photo'];
    
    words.forEach(word => {
        if (commonTags.includes(word) && !tags.includes(word)) {
            tags.push(word);
        }
    });
    
    return tags.slice(0, 5);
}

// === INTERACTION FUNCTIONS ===
async function toggleLike(promptId) {
    if (!currentUser) {
        showNotification('Please login to like prompts', 'error');
        return;
    }
    
    try {
        const promptRef = db.collection('prompts').doc(promptId);
        const promptDoc = await promptRef.get();
        const prompt = promptDoc.data();
        
        const likeRef = db.collection('likes').doc(`${currentUser.uid}_${promptId}`);
        const likeDoc = await likeRef.get();
        
        if (likeDoc.exists) {
            // Unlike
            await likeRef.delete();
            await promptRef.update({
                likes: firebase.firestore.FieldValue.increment(-1)
            });
            showNotification('Prompt unliked', 'info');
        } else {
            // Like
            await likeRef.set({
                userId: currentUser.uid,
                promptId: promptId,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            await promptRef.update({
                likes: firebase.firestore.FieldValue.increment(1)
            });
            showNotification('Prompt liked!', 'success');
        }
        
        loadPrompts();
    } catch (error) {
        console.error('Like error:', error);
        showNotification('Error liking prompt', 'error');
    }
}

async function toggleFavorite(promptId) {
    if (!currentUser) {
        showNotification('Please login to favorite prompts', 'error');
        return;
    }
    
    try {
        const favoriteRef = db.collection('favorites').doc(`${currentUser.uid}_${promptId}`);
        const favoriteDoc = await favoriteRef.get();
        
        if (favoriteDoc.exists) {
            await favoriteRef.delete();
            showNotification('Removed from favorites', 'info');
        } else {
            await favoriteRef.set({
                userId: currentUser.uid,
                promptId: promptId,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            showNotification('Added to favorites!', 'success');
        }
        
        loadPrompts();
    } catch (error) {
        console.error('Favorite error:', error);
        showNotification('Error favoriting prompt', 'error');
    }
}

async function addComment(promptId, inputElement) {
    if (!currentUser) {
        showNotification('Please login to comment', 'error');
        return;
    }
    
    const commentText = inputElement.value.trim();
    if (!commentText) return;
    
    try {
        await db.collection('comments').add({
            promptId: promptId,
            userId: currentUser.uid,
            userName: currentUser.displayName || 'User',
            userAvatar: currentUser.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.displayName || 'User')}&background=random`,
            text: commentText,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        inputElement.value = '';
        showNotification('Comment added!', 'success');
        
        // Reload comments for this prompt
        loadComments(promptId);
    } catch (error) {
        console.error('Comment error:', error);
        showNotification('Error adding comment', 'error');
    }
}

async function loadComments(promptId) {
    try {
        const snapshot = await db.collection('comments')
            .where('promptId', '==', promptId)
            .orderBy('createdAt', 'desc')
            .get();
        
        const comments = [];
        snapshot.forEach(doc => {
            comments.push(doc.data());
        });
        
        // Update comments display
        const promptCard = document.querySelector(`[data-prompt-id="${promptId}"]`);
        if (promptCard) {
            const commentsSection = promptCard.querySelector('.comments-section');
            commentsSection.innerHTML = `
                <div class="add-comment">
                    <textarea class="comment-input" placeholder="Add a comment..." 
                              onkeypress="if(event.key === 'Enter') addComment('${promptId}', this)"></textarea>
                    <button class="comment-btn" onclick="addComment('${promptId}', this.previousElementSibling)">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <div class="comments-list">
                    ${comments.map(comment => `
                        <div class="comment">
                            <div class="comment-header">
                                <div class="comment-author">
                                    <img src="${comment.userAvatar}" alt="${comment.userName}" class="comment-avatar">
                                    <span class="comment-author-name">${comment.userName}</span>
                                </div>
                                <span class="comment-time">${formatTime(comment.createdAt)}</span>
                            </div>
                            <div class="comment-text">${comment.text}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
    } catch (error) {
        console.error('Error loading comments:', error);
    }
}

// === FOLLOW SYSTEM ===
async function followUser(userId) {
    if (!currentUser) {
        showNotification('Please login to follow users', 'error');
        return;
    }
    
    try {
        const followRef = db.collection('follows').doc(`${currentUser.uid}_${userId}`);
        const followDoc = await followRef.get();
        
        if (followDoc.exists) {
            // Unfollow
            await followRef.delete();
            await db.collection('users').doc(currentUser.uid).update({
                following: firebase.firestore.FieldValue.arrayRemove(userId)
            });
            await db.collection('users').doc(userId).update({
                followers: firebase.firestore.FieldValue.arrayRemove(currentUser.uid)
            });
            showNotification('Unfollowed user', 'info');
        } else {
            // Follow
            await followRef.set({
                followerId: currentUser.uid,
                followingId: userId,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            await db.collection('users').doc(currentUser.uid).update({
                following: firebase.firestore.FieldValue.arrayUnion(userId)
            });
            await db.collection('users').doc(userId).update({
                followers: firebase.firestore.FieldValue.arrayUnion(currentUser.uid)
            });
            showNotification('User followed!', 'success');
        }
        
        loadUserProfile();
    } catch (error) {
        console.error('Follow error:', error);
        showNotification('Error following user', 'error');
    }
}

// === INBOX SYSTEM ===
async function loadInbox() {
    if (!currentUser) {
        document.getElementById('inboxList').innerHTML = `
            <div class="empty-state">
                <i class="fas fa-inbox"></i>
                <p>Please login to view your inbox</p>
            </div>
        `;
        return;
    }
    
    try {
        const snapshot = await db.collection('messages')
            .where('receiverId', '==', currentUser.uid)
            .orderBy('createdAt', 'desc')
            .get();
        
        const messages = [];
        snapshot.forEach(doc => {
            messages.push({ id: doc.id, ...doc.data() });
        });
        
        displayInbox(messages);
    } catch (error) {
        console.error('Error loading inbox:', error);
    }
}

function displayInbox(messages) {
    const inboxList = document.getElementById('inboxList');
    
    if (messages.length === 0) {
        inboxList.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-inbox"></i>
                <p>No messages yet</p>
            </div>
        `;
        return;
    }
    
    inboxList.innerHTML = messages.map(message => `
        <div class="inbox-item ${message.read ? '' : 'unread'}" onclick="openMessage('${message.id}')">
            <div class="inbox-sender">
                <img src="${message.senderAvatar}" alt="${message.senderName}" class="inbox-avatar">
                <strong>${message.senderName}</strong>
            </div>
            <p>${message.subject}</p>
            <small>${formatTime(message.createdAt)}</small>
        </div>
    `).join('');
}

// === UTILITY FUNCTIONS ===
function formatTime(timestamp) {
    if (!timestamp) return 'Just now';
    
    const date = timestamp.toDate();
    const now = new Date();
    const diff = now - date;
    
    const minutes = Math.floor(diff / 60000);
    const hours = Math.floor(diff / 3600000);
    const days = Math.floor(diff / 86400000);
    
    if (minutes < 1) return 'Just now';
    if (minutes < 60) return `${minutes}m ago`;
    if (hours < 24) return `${hours}h ago`;
    if (days < 7) return `${days}d ago`;
    
    return date.toLocaleDateString();
}

function showNotification(message, type = 'info') {
    // Create notification element
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info'}"></i>
        <span>${message}</span>
    `;
    
    // Add styles
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--error)' : 'var(--primary)'};
        color: white;
        padding: 15px 20px;
        border-radius: var(--radius);
        box-shadow: var(--shadow-dark);
        z-index: 10000;
        display: flex;
        align-items: center;
        gap: 10px;
        animation: slideInRight 0.3s ease;
    `;
    
    document.body.appendChild(notification);
    
    // Remove after 3 seconds
    setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s ease';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

async function updateStats() {
    try {
        // Get total prompts count
        const promptsSnapshot = await db.collection('prompts').get();
        elements.totalPrompts.textContent = promptsSnapshot.size;
        
        // Get total users count
        const usersSnapshot = await db.collection('users').get();
        elements.totalUsers.textContent = usersSnapshot.size;
        
        // Calculate total downloads
        let totalDownloads = 0;
        promptsSnapshot.forEach(doc => {
            totalDownloads += (doc.data().downloads || 0);
        });
        elements.totalDownloads.textContent = totalDownloads;
        
    } catch (error) {
        console.error('Error updating stats:', error);
    }
}

// === SEARCH FUNCTIONALITY ===
elements.searchBtn.addEventListener('click', performSearch);
elements.searchBox.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        performSearch();
    }
});

async function performSearch() {
    const query = elements.searchBox.value.trim().toLowerCase();
    
    if (!query) {
        loadPrompts();
        return;
    }
    
    const filteredPrompts = prompts.filter(prompt => 
        prompt.title.toLowerCase().includes(query) ||
        prompt.text.toLowerCase().includes(query) ||
        prompt.category.toLowerCase().includes(query) ||
        (prompt.tags && prompt.tags.some(tag => tag.toLowerCase().includes(query)))
    );
    
    displayPrompts(filteredPrompts);
}

// === INITIALIZATION ===
function initApp() {
    initTheme();
    initAuth();
    setupModals();
    setupNavigation();
    loadPrompts();
    
    // Add CSS animations
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
    `;
    document.head.appendChild(style);
}

// Start the app
document.addEventListener('DOMContentLoaded', initApp);

// === ADDITIONAL PAGE FUNCTIONS ===
async function loadUserProfile() {
    if (!currentUser) return;
    
    try {
        const userDoc = await db.collection('users').doc(currentUser.uid).get();
        if (userDoc.exists) {
            const userData = userDoc.data();
            
            document.getElementById('profileName').textContent = userData.name;
            document.getElementById('profileBio').textContent = userData.bio;
            document.getElementById('profileAvatar').src = userData.avatar;
            document.getElementById('profilePrompts').textContent = userData.prompts || 0;
            document.getElementById('profileFollowers').textContent = userData.followers ? userData.followers.length : 0;
            document.getElementById('profileFollowing').textContent = userData.following ? userData.following.length : 0;
            
            // Load user's prompts
            const userPromptsSnapshot = await db.collection('prompts')
                .where('authorId', '==', currentUser.uid)
                .orderBy('createdAt', 'desc')
                .get();
            
            const userPrompts = [];
            userPromptsSnapshot.forEach(doc => {
                userPrompts.push({ id: doc.id, ...doc.data() });
            });
            
            displayUserPrompts(userPrompts);
        }
    } catch (error) {
        console.error('Error loading user profile:', error);
    }
}

function displayUserPrompts(prompts) {
    const profileGallery = document.getElementById('profileGallery');
    
    if (prompts.length === 0) {
        profileGallery.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-images"></i>
                <p>No prompts yet. Upload your first prompt!</p>
            </div>
        `;
        return;
    }
    
    profileGallery.innerHTML = prompts.map(prompt => `
        <div class="prompt-card">
            <img src="${prompt.imageUrl || 'https://via.placeholder.com/400x300/667eea/white?text=AI+Art'}" 
                 alt="${prompt.title}" class="prompt-image">
            <div class="prompt-content">
                <h3 class="prompt-title">${prompt.title}</h3>
                <div class="prompt-text">${prompt.text}</div>
                <div class="prompt-meta">
                    <div class="prompt-stats">
                        <div class="stat">
                            <span class="stat-count">${prompt.likes || 0}</span>
                            <span class="stat-label">Likes</span>
                        </div>
                        <div class="stat">
                            <span class="stat-count">${prompt.downloads || 0}</span>
                            <span class="stat-label">Downloads</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `).join('');
}

async function loadFollowing() {
    if (!currentUser) return;
    
    // Implementation for loading following list
    document.getElementById('followingList').innerHTML = `
        <div class="empty-state">
            <i class="fas fa-users"></i>
            <p>Following feature coming soon!</p>
        </div>
    `;
}

// Export functions to global scope for HTML onclick handlers
window.toggleLike = toggleLike;
window.toggleFavorite = toggleFavorite;
window.addComment = addComment;
window.followUser = followUser;
